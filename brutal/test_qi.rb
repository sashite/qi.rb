# frozen_string_literal: true

require "simplecov"

::SimpleCov.command_name "Brutal test suite"
::SimpleCov.start

begin
  require_relative "../lib/qi"
rescue ::LoadError
  require "../lib/qi"
end

STARTING_POSITION_CONTEXT = [
  false,
  [],
  [],
  {
    0  => "l",
    1  => "n",
    2  => "s",
    3  => "g",
    4  => "k",
    5  => "g",
    6  => "s",
    7  => "n",
    8  => "l",
    10 => "r",
    16 => "b",
    18 => "p",
    19 => "p",
    20 => "p",
    21 => "p",
    22 => "p",
    23 => "p",
    24 => "p",
    25 => "p",
    26 => "p",
    54 => "P",
    55 => "P",
    56 => "P",
    57 => "P",
    58 => "P",
    59 => "P",
    60 => "P",
    61 => "P",
    62 => "P",
    64 => "B",
    70 => "R",
    72 => "L",
    73 => "N",
    74 => "S",
    75 => "G",
    76 => "K",
    77 => "G",
    78 => "S",
    79 => "N",
    80 => "L"
  }
].freeze

# ------------------------------------------------------------------------------

# Starting a test

actual = begin
  starting_position = Qi.new(*STARTING_POSITION_CONTEXT)

  [].reduce(starting_position) do |position, args|
    position.commit(*args)
  end
end

raise if actual.north_captures != []
raise if actual.south_captures != []
if actual.squares != { 0 => "l", 1 => "n", 2 => "s", 3 => "g", 4 => "k", 5 => "g", 6 => "s", 7 => "n", 8 => "l", 10 => "r", 16 => "b", 18 => "p", 19 => "p", 20 => "p", 21 => "p", 22 => "p", 23 => "p", 24 => "p", 25 => "p", 26 => "p", 54 => "P", 55 => "P", 56 => "P", 57 => "P", 58 => "P", 59 => "P", 60 => "P", 61 => "P", 62 => "P", 64 => "B", 70 => "R", 72 => "L", 73 => "N", 74 => "S", 75 => "G", 76 => "K", 77 => "G", 78 => "S", 79 => "N", 80 => "L" }
  raise
end
raise if (actual == Qi.new(*STARTING_POSITION_CONTEXT)) != true
raise if actual.eql?(Qi.new(*STARTING_POSITION_CONTEXT)) != true
raise if actual.current_captures != []
raise if actual.opponent_captures != []
raise if actual.current_turn != :South
raise if actual.next_turn != :North
raise if actual.north_turn? != false
raise if actual.south_turn? != true
raise if actual.options != {}
if actual.to_a != [false, [], [], { 0 => "l", 1 => "n", 2 => "s", 3 => "g", 4 => "k", 5 => "g", 6 => "s", 7 => "n", 8 => "l", 10 => "r", 16 => "b", 18 => "p", 19 => "p", 20 => "p", 21 => "p", 22 => "p", 23 => "p", 24 => "p", 25 => "p", 26 => "p", 54 => "P", 55 => "P", 56 => "P", 57 => "P", 58 => "P", 59 => "P", 60 => "P", 61 => "P", 62 => "P", 64 => "B", 70 => "R", 72 => "L", 73 => "N", 74 => "S", 75 => "G", 76 => "K", 77 => "G", 78 => "S", 79 => "N", 80 => "L" }, {}]
  raise
end
if actual.to_h != { is_north_turn: false, north_captures: [], south_captures: [], squares: { 0 => "l", 1 => "n", 2 => "s", 3 => "g", 4 => "k", 5 => "g", 6 => "s", 7 => "n", 8 => "l", 10 => "r", 16 => "b", 18 => "p", 19 => "p", 20 => "p", 21 => "p", 22 => "p", 23 => "p", 24 => "p", 25 => "p", 26 => "p", 54 => "P", 55 => "P", 56 => "P", 57 => "P", 58 => "P", 59 => "P", 60 => "P", 61 => "P", 62 => "P", 64 => "B", 70 => "R", 72 => "L", 73 => "N", 74 => "S", 75 => "G", 76 => "K", 77 => "G", 78 => "S", 79 => "N", 80 => "L" }, options: {} }
  raise
end
raise if actual.hash != "01fb91c3f48e3829c5ebb2711a859984423a2d9eb4b7634c3bb69ea68b73c777"
if actual.serialize != "South-turn======0:l,1:n,2:s,3:g,4:k,5:g,6:s,7:n,8:l,10:r,16:b,18:p,19:p,20:p,21:p,22:p,23:p,24:p,25:p,26:p,54:P,55:P,56:P,57:P,58:P,59:P,60:P,61:P,62:P,64:B,70:R,72:L,73:N,74:S,75:G,76:K,77:G,78:S,79:N,80:L"
  raise
end
if actual.inspect != "<Qi South-turn======0:l,1:n,2:s,3:g,4:k,5:g,6:s,7:n,8:l,10:r,16:b,18:p,19:p,20:p,21:p,22:p,23:p,24:p,25:p,26:p,54:P,55:P,56:P,57:P,58:P,59:P,60:P,61:P,62:P,64:B,70:R,72:L,73:N,74:S,75:G,76:K,77:G,78:S,79:N,80:L>"
  raise
end

# Finishing a test

# ------------------------------------------------------------------------------

# Starting a test

actual = begin
  starting_position = Qi.new(*STARTING_POSITION_CONTEXT)

  [[56, 47, "P", nil]].reduce(starting_position) do |position, args|
    position.commit(*args)
  end
end

raise if actual.north_captures != []
raise if actual.south_captures != []
if actual.squares != { 0 => "l", 1 => "n", 2 => "s", 3 => "g", 4 => "k", 5 => "g", 6 => "s", 7 => "n", 8 => "l", 10 => "r", 16 => "b", 18 => "p", 19 => "p", 20 => "p", 21 => "p", 22 => "p", 23 => "p", 24 => "p", 25 => "p", 26 => "p", 54 => "P", 55 => "P", 57 => "P", 58 => "P", 59 => "P", 60 => "P", 61 => "P", 62 => "P", 64 => "B", 70 => "R", 72 => "L", 73 => "N", 74 => "S", 75 => "G", 76 => "K", 77 => "G", 78 => "S", 79 => "N", 80 => "L", 47 => "P" }
  raise
end
raise if (actual == Qi.new(*STARTING_POSITION_CONTEXT)) != false
raise if actual.eql?(Qi.new(*STARTING_POSITION_CONTEXT)) != false
raise if actual.current_captures != []
raise if actual.opponent_captures != []
raise if actual.current_turn != :North
raise if actual.next_turn != :South
raise if actual.north_turn? != true
raise if actual.south_turn? != false
raise if actual.options != {}
if actual.to_a != [true, [], [], { 0 => "l", 1 => "n", 2 => "s", 3 => "g", 4 => "k", 5 => "g", 6 => "s", 7 => "n", 8 => "l", 10 => "r", 16 => "b", 18 => "p", 19 => "p", 20 => "p", 21 => "p", 22 => "p", 23 => "p", 24 => "p", 25 => "p", 26 => "p", 54 => "P", 55 => "P", 57 => "P", 58 => "P", 59 => "P", 60 => "P", 61 => "P", 62 => "P", 64 => "B", 70 => "R", 72 => "L", 73 => "N", 74 => "S", 75 => "G", 76 => "K", 77 => "G", 78 => "S", 79 => "N", 80 => "L", 47 => "P" }, {}]
  raise
end
if actual.to_h != { is_north_turn: true, north_captures: [], south_captures: [], squares: { 0 => "l", 1 => "n", 2 => "s", 3 => "g", 4 => "k", 5 => "g", 6 => "s", 7 => "n", 8 => "l", 10 => "r", 16 => "b", 18 => "p", 19 => "p", 20 => "p", 21 => "p", 22 => "p", 23 => "p", 24 => "p", 25 => "p", 26 => "p", 54 => "P", 55 => "P", 57 => "P", 58 => "P", 59 => "P", 60 => "P", 61 => "P", 62 => "P", 64 => "B", 70 => "R", 72 => "L", 73 => "N", 74 => "S", 75 => "G", 76 => "K", 77 => "G", 78 => "S", 79 => "N", 80 => "L", 47 => "P" }, options: {} }
  raise
end
raise if actual.hash != "cf85ac4eb960a9c67471c56987e331812a8807ca0c5d108d84417d142a3b863f"
if actual.serialize != "North-turn======0:l,1:n,2:s,3:g,4:k,5:g,6:s,7:n,8:l,10:r,16:b,18:p,19:p,20:p,21:p,22:p,23:p,24:p,25:p,26:p,47:P,54:P,55:P,57:P,58:P,59:P,60:P,61:P,62:P,64:B,70:R,72:L,73:N,74:S,75:G,76:K,77:G,78:S,79:N,80:L"
  raise
end
if actual.inspect != "<Qi North-turn======0:l,1:n,2:s,3:g,4:k,5:g,6:s,7:n,8:l,10:r,16:b,18:p,19:p,20:p,21:p,22:p,23:p,24:p,25:p,26:p,47:P,54:P,55:P,57:P,58:P,59:P,60:P,61:P,62:P,64:B,70:R,72:L,73:N,74:S,75:G,76:K,77:G,78:S,79:N,80:L>"
  raise
end

# Finishing a test

# ------------------------------------------------------------------------------

# Starting a test

actual = begin
  starting_position = Qi.new(*STARTING_POSITION_CONTEXT)

  [[56, 47, "P", nil], [3, 11, "g", nil]].reduce(starting_position) do |position, args|
    position.commit(*args)
  end
end

raise if actual.north_captures != []
raise if actual.south_captures != []
if actual.squares != { 0 => "l", 1 => "n", 2 => "s", 4 => "k", 5 => "g", 6 => "s", 7 => "n", 8 => "l", 10 => "r", 16 => "b", 18 => "p", 19 => "p", 20 => "p", 21 => "p", 22 => "p", 23 => "p", 24 => "p", 25 => "p", 26 => "p", 54 => "P", 55 => "P", 57 => "P", 58 => "P", 59 => "P", 60 => "P", 61 => "P", 62 => "P", 64 => "B", 70 => "R", 72 => "L", 73 => "N", 74 => "S", 75 => "G", 76 => "K", 77 => "G", 78 => "S", 79 => "N", 80 => "L", 47 => "P", 11 => "g" }
  raise
end
raise if (actual == Qi.new(*STARTING_POSITION_CONTEXT)) != false
raise if actual.eql?(Qi.new(*STARTING_POSITION_CONTEXT)) != false
raise if actual.current_captures != []
raise if actual.opponent_captures != []
raise if actual.current_turn != :South
raise if actual.next_turn != :North
raise if actual.north_turn? != false
raise if actual.south_turn? != true
raise if actual.options != {}
if actual.to_a != [false, [], [], { 0 => "l", 1 => "n", 2 => "s", 4 => "k", 5 => "g", 6 => "s", 7 => "n", 8 => "l", 10 => "r", 16 => "b", 18 => "p", 19 => "p", 20 => "p", 21 => "p", 22 => "p", 23 => "p", 24 => "p", 25 => "p", 26 => "p", 54 => "P", 55 => "P", 57 => "P", 58 => "P", 59 => "P", 60 => "P", 61 => "P", 62 => "P", 64 => "B", 70 => "R", 72 => "L", 73 => "N", 74 => "S", 75 => "G", 76 => "K", 77 => "G", 78 => "S", 79 => "N", 80 => "L", 47 => "P", 11 => "g" }, {}]
  raise
end
if actual.to_h != { is_north_turn: false, north_captures: [], south_captures: [], squares: { 0 => "l", 1 => "n", 2 => "s", 4 => "k", 5 => "g", 6 => "s", 7 => "n", 8 => "l", 10 => "r", 16 => "b", 18 => "p", 19 => "p", 20 => "p", 21 => "p", 22 => "p", 23 => "p", 24 => "p", 25 => "p", 26 => "p", 54 => "P", 55 => "P", 57 => "P", 58 => "P", 59 => "P", 60 => "P", 61 => "P", 62 => "P", 64 => "B", 70 => "R", 72 => "L", 73 => "N", 74 => "S", 75 => "G", 76 => "K", 77 => "G", 78 => "S", 79 => "N", 80 => "L", 47 => "P", 11 => "g" }, options: {} }
  raise
end
raise if actual.hash != "ee5525efa6fc04c61fe2c0ce8efb0e34fcd512b841e3e320c4a658ae08a22f4d"
if actual.serialize != "South-turn======0:l,1:n,2:s,4:k,5:g,6:s,7:n,8:l,10:r,11:g,16:b,18:p,19:p,20:p,21:p,22:p,23:p,24:p,25:p,26:p,47:P,54:P,55:P,57:P,58:P,59:P,60:P,61:P,62:P,64:B,70:R,72:L,73:N,74:S,75:G,76:K,77:G,78:S,79:N,80:L"
  raise
end
if actual.inspect != "<Qi South-turn======0:l,1:n,2:s,4:k,5:g,6:s,7:n,8:l,10:r,11:g,16:b,18:p,19:p,20:p,21:p,22:p,23:p,24:p,25:p,26:p,47:P,54:P,55:P,57:P,58:P,59:P,60:P,61:P,62:P,64:B,70:R,72:L,73:N,74:S,75:G,76:K,77:G,78:S,79:N,80:L>"
  raise
end

# Finishing a test

# ------------------------------------------------------------------------------

# Starting a test

actual = begin
  starting_position = Qi.new(*STARTING_POSITION_CONTEXT)

  [[56, 47, "P", nil], [3, 11, "g", nil], [64, 24, "+B", "P"]].reduce(starting_position) do |position, args|
    position.commit(*args)
  end
end

raise if actual.north_captures != []
raise if actual.south_captures != ["P"]
if actual.squares != { 0 => "l", 1 => "n", 2 => "s", 4 => "k", 5 => "g", 6 => "s", 7 => "n", 8 => "l", 10 => "r", 16 => "b", 18 => "p", 19 => "p", 20 => "p", 21 => "p", 22 => "p", 23 => "p", 24 => "+B", 25 => "p", 26 => "p", 54 => "P", 55 => "P", 57 => "P", 58 => "P", 59 => "P", 60 => "P", 61 => "P", 62 => "P", 70 => "R", 72 => "L", 73 => "N", 74 => "S", 75 => "G", 76 => "K", 77 => "G", 78 => "S", 79 => "N", 80 => "L", 47 => "P", 11 => "g" }
  raise
end
raise if (actual == Qi.new(*STARTING_POSITION_CONTEXT)) != false
raise if actual.eql?(Qi.new(*STARTING_POSITION_CONTEXT)) != false
raise if actual.current_captures != []
raise if actual.opponent_captures != ["P"]
raise if actual.current_turn != :North
raise if actual.next_turn != :South
raise if actual.north_turn? != true
raise if actual.south_turn? != false
raise if actual.options != {}
if actual.to_a != [true, [], ["P"], { 0 => "l", 1 => "n", 2 => "s", 4 => "k", 5 => "g", 6 => "s", 7 => "n", 8 => "l", 10 => "r", 16 => "b", 18 => "p", 19 => "p", 20 => "p", 21 => "p", 22 => "p", 23 => "p", 24 => "+B", 25 => "p", 26 => "p", 54 => "P", 55 => "P", 57 => "P", 58 => "P", 59 => "P", 60 => "P", 61 => "P", 62 => "P", 70 => "R", 72 => "L", 73 => "N", 74 => "S", 75 => "G", 76 => "K", 77 => "G", 78 => "S", 79 => "N", 80 => "L", 47 => "P", 11 => "g" }, {}]
  raise
end
if actual.to_h != { is_north_turn: true, north_captures: [], south_captures: ["P"], squares: { 0 => "l", 1 => "n", 2 => "s", 4 => "k", 5 => "g", 6 => "s", 7 => "n", 8 => "l", 10 => "r", 16 => "b", 18 => "p", 19 => "p", 20 => "p", 21 => "p", 22 => "p", 23 => "p", 24 => "+B", 25 => "p", 26 => "p", 54 => "P", 55 => "P", 57 => "P", 58 => "P", 59 => "P", 60 => "P", 61 => "P", 62 => "P", 70 => "R", 72 => "L", 73 => "N", 74 => "S", 75 => "G", 76 => "K", 77 => "G", 78 => "S", 79 => "N", 80 => "L", 47 => "P", 11 => "g" }, options: {} }
  raise
end
raise if actual.hash != "23a1d830d6d4bf73fe9bf721984d8f40c8638b9306c3a2ce3dd236df2b978246"
if actual.serialize != "North-turn===P===0:l,1:n,2:s,4:k,5:g,6:s,7:n,8:l,10:r,11:g,16:b,18:p,19:p,20:p,21:p,22:p,23:p,24:+B,25:p,26:p,47:P,54:P,55:P,57:P,58:P,59:P,60:P,61:P,62:P,70:R,72:L,73:N,74:S,75:G,76:K,77:G,78:S,79:N,80:L"
  raise
end
if actual.inspect != "<Qi North-turn===P===0:l,1:n,2:s,4:k,5:g,6:s,7:n,8:l,10:r,11:g,16:b,18:p,19:p,20:p,21:p,22:p,23:p,24:+B,25:p,26:p,47:P,54:P,55:P,57:P,58:P,59:P,60:P,61:P,62:P,70:R,72:L,73:N,74:S,75:G,76:K,77:G,78:S,79:N,80:L>"
  raise
end

# Finishing a test

# ------------------------------------------------------------------------------

# Starting a test

actual = begin
  starting_position = Qi.new(*STARTING_POSITION_CONTEXT)

  [[56, 47, "P", nil], [3, 11, "g", nil], [64, 24, "+B", "P"], [5, 14, "g", nil]].reduce(starting_position) do |position, args|
    position.commit(*args)
  end
end

raise if actual.north_captures != []
raise if actual.south_captures != ["P"]
if actual.squares != { 0 => "l", 1 => "n", 2 => "s", 4 => "k", 6 => "s", 7 => "n", 8 => "l", 10 => "r", 16 => "b", 18 => "p", 19 => "p", 20 => "p", 21 => "p", 22 => "p", 23 => "p", 24 => "+B", 25 => "p", 26 => "p", 54 => "P", 55 => "P", 57 => "P", 58 => "P", 59 => "P", 60 => "P", 61 => "P", 62 => "P", 70 => "R", 72 => "L", 73 => "N", 74 => "S", 75 => "G", 76 => "K", 77 => "G", 78 => "S", 79 => "N", 80 => "L", 47 => "P", 11 => "g", 14 => "g" }
  raise
end
raise if (actual == Qi.new(*STARTING_POSITION_CONTEXT)) != false
raise if actual.eql?(Qi.new(*STARTING_POSITION_CONTEXT)) != false
raise if actual.current_captures != ["P"]
raise if actual.opponent_captures != []
raise if actual.current_turn != :South
raise if actual.next_turn != :North
raise if actual.north_turn? != false
raise if actual.south_turn? != true
raise if actual.options != {}
if actual.to_a != [false, [], ["P"], { 0 => "l", 1 => "n", 2 => "s", 4 => "k", 6 => "s", 7 => "n", 8 => "l", 10 => "r", 16 => "b", 18 => "p", 19 => "p", 20 => "p", 21 => "p", 22 => "p", 23 => "p", 24 => "+B", 25 => "p", 26 => "p", 54 => "P", 55 => "P", 57 => "P", 58 => "P", 59 => "P", 60 => "P", 61 => "P", 62 => "P", 70 => "R", 72 => "L", 73 => "N", 74 => "S", 75 => "G", 76 => "K", 77 => "G", 78 => "S", 79 => "N", 80 => "L", 47 => "P", 11 => "g", 14 => "g" }, {}]
  raise
end
if actual.to_h != { is_north_turn: false, north_captures: [], south_captures: ["P"], squares: { 0 => "l", 1 => "n", 2 => "s", 4 => "k", 6 => "s", 7 => "n", 8 => "l", 10 => "r", 16 => "b", 18 => "p", 19 => "p", 20 => "p", 21 => "p", 22 => "p", 23 => "p", 24 => "+B", 25 => "p", 26 => "p", 54 => "P", 55 => "P", 57 => "P", 58 => "P", 59 => "P", 60 => "P", 61 => "P", 62 => "P", 70 => "R", 72 => "L", 73 => "N", 74 => "S", 75 => "G", 76 => "K", 77 => "G", 78 => "S", 79 => "N", 80 => "L", 47 => "P", 11 => "g", 14 => "g" }, options: {} }
  raise
end
raise if actual.hash != "82e56afd51db188cf330057b74031da5d4d636d88b96188a63abde8b6d7141d3"
if actual.serialize != "South-turn===P===0:l,1:n,2:s,4:k,6:s,7:n,8:l,10:r,11:g,14:g,16:b,18:p,19:p,20:p,21:p,22:p,23:p,24:+B,25:p,26:p,47:P,54:P,55:P,57:P,58:P,59:P,60:P,61:P,62:P,70:R,72:L,73:N,74:S,75:G,76:K,77:G,78:S,79:N,80:L"
  raise
end
if actual.inspect != "<Qi South-turn===P===0:l,1:n,2:s,4:k,6:s,7:n,8:l,10:r,11:g,14:g,16:b,18:p,19:p,20:p,21:p,22:p,23:p,24:+B,25:p,26:p,47:P,54:P,55:P,57:P,58:P,59:P,60:P,61:P,62:P,70:R,72:L,73:N,74:S,75:G,76:K,77:G,78:S,79:N,80:L>"
  raise
end

# Finishing a test

# ------------------------------------------------------------------------------

# Starting a test

actual = begin
  starting_position = Qi.new(*STARTING_POSITION_CONTEXT)

  [[56, 47, "P", nil], [3, 11, "g", nil], [64, 24, "+B", "P"], [5, 14, "g", nil], [24, 14, "+B", "G"]].reduce(starting_position) do |position, args|
    position.commit(*args)
  end
end

raise if actual.north_captures != []
raise if actual.south_captures != %w[G P]
if actual.squares != { 0 => "l", 1 => "n", 2 => "s", 4 => "k", 6 => "s", 7 => "n", 8 => "l", 10 => "r", 16 => "b", 18 => "p", 19 => "p", 20 => "p", 21 => "p", 22 => "p", 23 => "p", 25 => "p", 26 => "p", 54 => "P", 55 => "P", 57 => "P", 58 => "P", 59 => "P", 60 => "P", 61 => "P", 62 => "P", 70 => "R", 72 => "L", 73 => "N", 74 => "S", 75 => "G", 76 => "K", 77 => "G", 78 => "S", 79 => "N", 80 => "L", 47 => "P", 11 => "g", 14 => "+B" }
  raise
end
raise if (actual == Qi.new(*STARTING_POSITION_CONTEXT)) != false
raise if actual.eql?(Qi.new(*STARTING_POSITION_CONTEXT)) != false
raise if actual.current_captures != []
raise if actual.opponent_captures != %w[G P]
raise if actual.current_turn != :North
raise if actual.next_turn != :South
raise if actual.north_turn? != true
raise if actual.south_turn? != false
raise if actual.options != {}
if actual.to_a != [true, [], %w[G P], { 0 => "l", 1 => "n", 2 => "s", 4 => "k", 6 => "s", 7 => "n", 8 => "l", 10 => "r", 16 => "b", 18 => "p", 19 => "p", 20 => "p", 21 => "p", 22 => "p", 23 => "p", 25 => "p", 26 => "p", 54 => "P", 55 => "P", 57 => "P", 58 => "P", 59 => "P", 60 => "P", 61 => "P", 62 => "P", 70 => "R", 72 => "L", 73 => "N", 74 => "S", 75 => "G", 76 => "K", 77 => "G", 78 => "S", 79 => "N", 80 => "L", 47 => "P", 11 => "g", 14 => "+B" }, {}]
  raise
end
if actual.to_h != { is_north_turn: true, north_captures: [], south_captures: %w[G P], squares: { 0 => "l", 1 => "n", 2 => "s", 4 => "k", 6 => "s", 7 => "n", 8 => "l", 10 => "r", 16 => "b", 18 => "p", 19 => "p", 20 => "p", 21 => "p", 22 => "p", 23 => "p", 25 => "p", 26 => "p", 54 => "P", 55 => "P", 57 => "P", 58 => "P", 59 => "P", 60 => "P", 61 => "P", 62 => "P", 70 => "R", 72 => "L", 73 => "N", 74 => "S", 75 => "G", 76 => "K", 77 => "G", 78 => "S", 79 => "N", 80 => "L", 47 => "P", 11 => "g", 14 => "+B" }, options: {} }
  raise
end
raise if actual.hash != "1c3fab4f48496c2fd042cb3fd991bd86336aa951b713bf65eaaa109b12aabc62"
if actual.serialize != "North-turn===G,P===0:l,1:n,2:s,4:k,6:s,7:n,8:l,10:r,11:g,14:+B,16:b,18:p,19:p,20:p,21:p,22:p,23:p,25:p,26:p,47:P,54:P,55:P,57:P,58:P,59:P,60:P,61:P,62:P,70:R,72:L,73:N,74:S,75:G,76:K,77:G,78:S,79:N,80:L"
  raise
end
if actual.inspect != "<Qi North-turn===G,P===0:l,1:n,2:s,4:k,6:s,7:n,8:l,10:r,11:g,14:+B,16:b,18:p,19:p,20:p,21:p,22:p,23:p,25:p,26:p,47:P,54:P,55:P,57:P,58:P,59:P,60:P,61:P,62:P,70:R,72:L,73:N,74:S,75:G,76:K,77:G,78:S,79:N,80:L>"
  raise
end

# Finishing a test

# ------------------------------------------------------------------------------

# Starting a test

actual = begin
  starting_position = Qi.new(*STARTING_POSITION_CONTEXT)

  [[56, 47, "P", nil], [3, 11, "g", nil], [64, 24, "+B", "P"], [5, 14, "g", nil], [24, 14, "+B", "G"], [4, 3, "k", nil]].reduce(starting_position) do |position, args|
    position.commit(*args)
  end
end

raise if actual.north_captures != []
raise if actual.south_captures != %w[G P]
if actual.squares != { 0 => "l", 1 => "n", 2 => "s", 6 => "s", 7 => "n", 8 => "l", 10 => "r", 16 => "b", 18 => "p", 19 => "p", 20 => "p", 21 => "p", 22 => "p", 23 => "p", 25 => "p", 26 => "p", 54 => "P", 55 => "P", 57 => "P", 58 => "P", 59 => "P", 60 => "P", 61 => "P", 62 => "P", 70 => "R", 72 => "L", 73 => "N", 74 => "S", 75 => "G", 76 => "K", 77 => "G", 78 => "S", 79 => "N", 80 => "L", 47 => "P", 11 => "g", 14 => "+B", 3 => "k" }
  raise
end
raise if (actual == Qi.new(*STARTING_POSITION_CONTEXT)) != false
raise if actual.eql?(Qi.new(*STARTING_POSITION_CONTEXT)) != false
raise if actual.current_captures != %w[G P]
raise if actual.opponent_captures != []
raise if actual.current_turn != :South
raise if actual.next_turn != :North
raise if actual.north_turn? != false
raise if actual.south_turn? != true
raise if actual.options != {}
if actual.to_a != [false, [], %w[G P], { 0 => "l", 1 => "n", 2 => "s", 6 => "s", 7 => "n", 8 => "l", 10 => "r", 16 => "b", 18 => "p", 19 => "p", 20 => "p", 21 => "p", 22 => "p", 23 => "p", 25 => "p", 26 => "p", 54 => "P", 55 => "P", 57 => "P", 58 => "P", 59 => "P", 60 => "P", 61 => "P", 62 => "P", 70 => "R", 72 => "L", 73 => "N", 74 => "S", 75 => "G", 76 => "K", 77 => "G", 78 => "S", 79 => "N", 80 => "L", 47 => "P", 11 => "g", 14 => "+B", 3 => "k" }, {}]
  raise
end
if actual.to_h != { is_north_turn: false, north_captures: [], south_captures: %w[G P], squares: { 0 => "l", 1 => "n", 2 => "s", 6 => "s", 7 => "n", 8 => "l", 10 => "r", 16 => "b", 18 => "p", 19 => "p", 20 => "p", 21 => "p", 22 => "p", 23 => "p", 25 => "p", 26 => "p", 54 => "P", 55 => "P", 57 => "P", 58 => "P", 59 => "P", 60 => "P", 61 => "P", 62 => "P", 70 => "R", 72 => "L", 73 => "N", 74 => "S", 75 => "G", 76 => "K", 77 => "G", 78 => "S", 79 => "N", 80 => "L", 47 => "P", 11 => "g", 14 => "+B", 3 => "k" }, options: {} }
  raise
end
raise if actual.hash != "2f9347d00e0aba921b3f6b7df79c5130aebd568b8e0d14976bf999b5f15f589f"
if actual.serialize != "South-turn===G,P===0:l,1:n,2:s,3:k,6:s,7:n,8:l,10:r,11:g,14:+B,16:b,18:p,19:p,20:p,21:p,22:p,23:p,25:p,26:p,47:P,54:P,55:P,57:P,58:P,59:P,60:P,61:P,62:P,70:R,72:L,73:N,74:S,75:G,76:K,77:G,78:S,79:N,80:L"
  raise
end
if actual.inspect != "<Qi South-turn===G,P===0:l,1:n,2:s,3:k,6:s,7:n,8:l,10:r,11:g,14:+B,16:b,18:p,19:p,20:p,21:p,22:p,23:p,25:p,26:p,47:P,54:P,55:P,57:P,58:P,59:P,60:P,61:P,62:P,70:R,72:L,73:N,74:S,75:G,76:K,77:G,78:S,79:N,80:L>"
  raise
end

# Finishing a test

# ------------------------------------------------------------------------------

# Starting a test

actual = begin
  starting_position = Qi.new(*STARTING_POSITION_CONTEXT)

  [[56, 47, "P", nil], [3, 11, "g", nil], [64, 24, "+B", "P"], [5, 14, "g", nil], [24, 14, "+B", "G"], [4, 3, "k", nil], [nil, 13, "G", "G"]].reduce(starting_position) do |position, args|
    position.commit(*args)
  end
end

raise if actual.north_captures != []
raise if actual.south_captures != ["P"]
if actual.squares != { 0 => "l", 1 => "n", 2 => "s", 6 => "s", 7 => "n", 8 => "l", 10 => "r", 16 => "b", 18 => "p", 19 => "p", 20 => "p", 21 => "p", 22 => "p", 23 => "p", 25 => "p", 26 => "p", 54 => "P", 55 => "P", 57 => "P", 58 => "P", 59 => "P", 60 => "P", 61 => "P", 62 => "P", 70 => "R", 72 => "L", 73 => "N", 74 => "S", 75 => "G", 76 => "K", 77 => "G", 78 => "S", 79 => "N", 80 => "L", 47 => "P", 11 => "g", 14 => "+B", 3 => "k", 13 => "G" }
  raise
end
raise if (actual == Qi.new(*STARTING_POSITION_CONTEXT)) != false
raise if actual.eql?(Qi.new(*STARTING_POSITION_CONTEXT)) != false
raise if actual.current_captures != []
raise if actual.opponent_captures != ["P"]
raise if actual.current_turn != :North
raise if actual.next_turn != :South
raise if actual.north_turn? != true
raise if actual.south_turn? != false
raise if actual.options != {}
if actual.to_a != [true, [], ["P"], { 0 => "l", 1 => "n", 2 => "s", 6 => "s", 7 => "n", 8 => "l", 10 => "r", 16 => "b", 18 => "p", 19 => "p", 20 => "p", 21 => "p", 22 => "p", 23 => "p", 25 => "p", 26 => "p", 54 => "P", 55 => "P", 57 => "P", 58 => "P", 59 => "P", 60 => "P", 61 => "P", 62 => "P", 70 => "R", 72 => "L", 73 => "N", 74 => "S", 75 => "G", 76 => "K", 77 => "G", 78 => "S", 79 => "N", 80 => "L", 47 => "P", 11 => "g", 14 => "+B", 3 => "k", 13 => "G" }, {}]
  raise
end
if actual.to_h != { is_north_turn: true, north_captures: [], south_captures: ["P"], squares: { 0 => "l", 1 => "n", 2 => "s", 6 => "s", 7 => "n", 8 => "l", 10 => "r", 16 => "b", 18 => "p", 19 => "p", 20 => "p", 21 => "p", 22 => "p", 23 => "p", 25 => "p", 26 => "p", 54 => "P", 55 => "P", 57 => "P", 58 => "P", 59 => "P", 60 => "P", 61 => "P", 62 => "P", 70 => "R", 72 => "L", 73 => "N", 74 => "S", 75 => "G", 76 => "K", 77 => "G", 78 => "S", 79 => "N", 80 => "L", 47 => "P", 11 => "g", 14 => "+B", 3 => "k", 13 => "G" }, options: {} }
  raise
end
raise if actual.hash != "e83e49479f7a307077ac1ddc3331fc15d1cb9debbaa438b0d1d0bb652a5ad453"
if actual.serialize != "North-turn===P===0:l,1:n,2:s,3:k,6:s,7:n,8:l,10:r,11:g,13:G,14:+B,16:b,18:p,19:p,20:p,21:p,22:p,23:p,25:p,26:p,47:P,54:P,55:P,57:P,58:P,59:P,60:P,61:P,62:P,70:R,72:L,73:N,74:S,75:G,76:K,77:G,78:S,79:N,80:L"
  raise
end
if actual.inspect != "<Qi North-turn===P===0:l,1:n,2:s,3:k,6:s,7:n,8:l,10:r,11:g,13:G,14:+B,16:b,18:p,19:p,20:p,21:p,22:p,23:p,25:p,26:p,47:P,54:P,55:P,57:P,58:P,59:P,60:P,61:P,62:P,70:R,72:L,73:N,74:S,75:G,76:K,77:G,78:S,79:N,80:L>"
  raise
end

# Finishing a test

# ------------------------------------------------------------------------------

# End of the brutal test
